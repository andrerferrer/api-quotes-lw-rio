<div class="container mt-5">
  <div class="my-4 d-flex justify-content-between align-items-center">
    <button><%= link_to "Home", root_path %> </button>
    <h3>Admin Dashboard</h3>
  </div>
    <div class="card p-4" >
      <h5>Who is already in:</h5>
      <ul>
        <li id="person-name" style="text-transform: capitalize"></li>
      </ul>
    </div>
    <div class="card mt-5 p-4">
      <h5>Hey! Who do you want to add inside this Wagon?</h5>
      <form id="new-person"> <!-- No need for action or method attributes  -->
        <input type="text" id="new-person-name">
        <input type="submit" id="add-person" value="Add a person">
      </form>
    </div>


  <script>

    const showPeople = (data) => {
      data.forEach( i => {
        let newLi = document.createElement('li')
        newLi.innerHTML = i.name
        document.getElementById("person-name").appendChild(newLi)
      })
    }

    const fetchPeople = (event) => {
      const url = "/api/v1/people"
      fetch(url)
        .then(res => res.json())
        .then(showPeople)
    }

    const leWagon = window.addEventListener('load', fetchPeople)


    //ADD a person
    const newPerson = document.getElementById("new-person")
    const newPersonInput = document.getElementById("new-person-name")

    newPerson.addEventListener("submit", (event) => {
      event.preventDefault();
      fetch("/api/v1/people", {
        method: "POST",
        headers: {
          "Accept": "application/json",
          "Content-Type": "application/json"
        },
        body: JSON.stringify({ person: { name: newPersonInput.value }})
      })
        .then(response => response.json())
        .then((data) => {
        })
        newPerson.submit()
        newPerson.reset()
    })





  </script>
</div>
